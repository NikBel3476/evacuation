# EvacuationC

**EvacuationC** -- программа моделирования движения людей в здании. 

Резульататом работы программы является время освобождения здания (длительность эвакуации).

# Структура проекта

```
.
├── res             -- Ресурсы. Файлы зданий
├── src             -- Исходные коды программы
├── src-tauri       -- Исходные коды управления графическим интерфейсом(язык Rust)
├── src-ui          -- Исходные коды управления графическим интерфейсом(язык TypeScript) 
├── test            -- Тесты
└── thirdparty      -- Библиотеки, используемые в программе
    ├── arraylist   -- Библиотека для работы с динамическим списком
    ├── c-logger    -- Библиотека для логгирования
    └── triangle    -- Библиотека для триангуляции поверхности
    
Используемые библиотеки Rust:
serde(serde_json) - библиотека для сериализации/десериализации json файлов
cc - библиотека для компиляции исходного кода языка Си и объединение его с основным исполянемым файлом
tauri - библиотека для создания графического интерфейса, основанная на библиотеке webview
```

# Сборка

## Интсрументарий
- Rust последней версии(rustup, rustc и cargo). [Ссылка для скачивания rust](https://www.rust-lang.org/tools/install)
- Node.js 16.x.x или более поздней версии [Ссылка для скачивания Node.js](https://nodejs.org/en)

# Запуск
1. Перейти в корневую директорию проекта
2. Выполнить команду `npm install` или `npm i` для установки зависимостей
3. Выполнить команду `npm run prepare` для инициализации скрипта pre-commit hook библиотеки husky
4. Выполнить команду `npm run tauri dev`

Настройки моделируемого сценария задаются в файле-сценарии. Он состоит из нескольких секций:
```
{
  "bim": [],                 -- список цифровых моделей зданий,
  "logger_configure": "",    -- путь к файлу с настроками логгирования
  "distribution": {},        -- настройки распределения людей в здании
  "transits": {},            -- настройки ширины проемов в здании
  "modeling": {}             -- настройки модели движения людского потока в здании
}
```

### distribution
Через блок `distribution` можно задать выбрать тип (`type`) распределения людей в здании:
```
uniform   -- равномерное распределение людей в здании с заданной плотностью (density)
from_bim  -- распеделение, которое задано в пространственно-информационной модели здания
```
В поле `density` указывается плотность начального количества людей, чел./м^2

В блоке `special` можно указать специальные настройки для одного или группы областей здания.
Этот блок обрабатывается всегда.

```
"distribution": {
    "type":"uniform",
    "density": 0.1,
    "special": [
        {
            "uuid": [
            "87c49613-44a7-4f3f-82e0-fb4a9ca2f46d"
            ],
            "density": 1.0,
            "_comment": "The uuid is Room_1 by three_zone_three_transit"
        }
    ]
  }
```

### transits


### modeling

